---
layout: post
title: "Symfony Live Paris 2017"
description: "Symfony Live Paris 2017"
author:
  name: Guillaume BOUYGE
  avatar:
  email:
  twitter: SuperFlaw
  facebook:
  github:
category:
tags: [symfony, symfony live, cache, cache-tagging]
image:
  feature: posts/prettier/military.jpg
  credit: Kevin Frayer
  creditlink: http://www.gettyimages.fr/
comments: true
language: en
---

## Varnish tags and invalidation
### Speaker : Jérémy Derussé
### Description
Jérémy presented us how to host applications on an production environment on a raspberry PI using varnish cache.
Today, the internet trafic and the number of unique visitors increase every days.
People imagines that we need strong hardware servers to be able to respond to this trafic.

The instersting part of this presentation was the way of how to smart use the cache in front of our applications.
To be able to minimize the number of server sides calls to it's minimum by being able to manage the cache duration
and being able to invalidate it on demand when a resource expire.

### How to tag and segment the cache
By tagging every resources by a unique id (entityName_id by example), you'll be able later to invalidate the cache linked to it.
You can simplify and automate this taggin by using event dispatcher and listen all entities creations / modifications. With
this solution you also centralize your logical code.

Cache tagging also helps you with caching / invalidating many-to-many relationships between content items.

### How to invalidate the cache
Jérémy showed us a very interesting interface, displaying the entity content and is automatic refresh when the backend needs to be call
because of a cache invalidation.

Once an ressource is modify and needs to be uncached, your backend needs to call the front cache tu purge the tag lined to matching
ressource. Once again the FOS HttpCache bunde do it very well (http://foshttpcachebundle.readthedocs.io/en/latest/reference/tag-handler.html).

### Advantages / incovinients 
Caching everything is fine, but it's has limitations :
**Works well when :**
* You have mostly read access
* You have more cache hit than miss
* Your application is able to communicate whit your cache solution

**Can be difficult with :**
* Operations are not atomics
* it's complexifying / slowing backend writes handles 

### Hosting on an respbery PI
Jérémy finnaly showed us an impressive demo of an application running on raspberry PI.
**The configuration :** 
* Docker
    * MySQL
    * NGINX
    * PHP7-FPM
    * Varnish
    
**The results :**
* Number of calls with no caching handling : arround 8 / secs
* Number of calls with varnish cache response : around 900 / secs
    * impressive !

### Ressources
You can manipulate cache by using the FOSHttpCacheBundle : https://github.com/FriendsOfSymfony/FOSHttpCacheBundle
Link to the speaker presentation : https://www.slideshare.net/JrmyDeruss/grce-aux-tags-varnish-jai-switch-ma-prod-sur-raspberry-pi

## Everything a dev should know about Unicode
### Speaker : Nicolas Grekas
### Description

Nicolas Grekas made a talk about Unicode, from its origin to the latest advanced uses, and more precisely in the PHP ecosystem. He explained how utf8/16 works and the complexity of language management, especially the folding, graphs clusters, modifiers etc.

PHP doesn't natively handle the unicode #RIPphp6, so it is important to understand the specificities of utf8 in order to avoid some traps, especially concerning string length calculation, comparisons and insertions in database.

In order to manage the unicode, you must use the php functions of mbstring, iconv, graph and inttl. The "u" modifier allows the utf8 to be processed correctly for regular expressions. For MySQL, utf8_unicode_ci handles ligatures whereas utf8_general_ci does not handle them - but is therefore faster.

Concerning security and avoiding typosquatting, there is a list of confisables characters for filtering: http://unicode.org/cldr/utility/confusables.jsp?a=6play&r=None

This presentation was very interesting and very useful. Thank you Nicolas ;-)

### Ressources
Link to the speaker presentation : https://speakerdeck.com/nicolasgrekas/tout-ce-quun-dev-devrait-savoir-a-propos-dunicode
